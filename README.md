# tencent_im_plugin
[![pub package](https://img.shields.io/pub/v/tencent_im_plugin.svg)](https://pub.dartlang.org/packages/tencent_im_plugin)

è…¾è®¯äº‘IMæ’ä»¶

## Getting Started
é›†æˆè…¾è®¯äº‘IM SDKï¼ŒåŒæ—¶æ”¯æŒ Android å’Œ IOS  
**ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ç¦»çº¿æ¨é€éƒ¨åˆ†æ¥å£å·²å®ç°ï¼Œå…³æ³¨ï¼š`setOfflinePushSettings`å’Œ`setOfflinePushToken`ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰**  
**æ³¨æ„ï¼šå½“å‰ä¸ºæµ‹è¯•ç‰ˆæœ¬ï¼Œå¦‚æœæ‚¨è¦é›†æˆåˆ°æ­£å¼é¡¹ç›®ï¼Œè¯·ä¿æŒå…³æ³¨æ–°ç‰ˆæœ¬ã€‚ç¨³å®šç‰ˆæœ¬å°†å¤§äºç­‰äº `v1.0.0`**  
**æ³¨æ„ï¼šç”±äºè…¾è®¯äº‘IMå‡çº§äº†æ–°ç‰ˆæœ¬ï¼Œä½†æ˜¯æœ¬æ’ä»¶åŸºäºä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œæ‰€ä»¥æµè§ˆå¼€å‘æ–‡æ¡£æ—¶è¯·é€šè¿‡ä»¥ä¸‹åœ°å€ï¼š[Android](https://cloud.tencent.com/document/product/269/36909) [IOS](https://cloud.tencent.com/document/product/269/36910) ï¼Œåœ¨å®ŒæˆåŸºæœ¬å·¥ä½œåï¼Œæ’ä»¶å°†è¿›è¡Œç›¸åº”æ›´æ–°**  

## åŠŸèƒ½æ¸…å•
[x]åˆå§‹åŒ–  
[x]ç™»å½•ç›¸å…³  
[x]æ¶ˆæ¯æ”¶å‘    
[x]æœªè¯»è®¡æ•°  
[x]ç¾¤ç»„ç›¸å…³  
[x]ç”¨æˆ·èµ„æ–™ä¸å…³ç³»é“¾  
[-]ç¦»çº¿æ¨é€  

### è¿‘æœŸè®¡åˆ’(å·²å®Œæˆå†…å®¹å°†ä¼šè¢«ç§»é™¤)  
[ ] å‡çº§IM SDKç‰ˆæœ¬  
[ ] éªŒè¯ MessageEntity åºåˆ—åŒ– toJson é—®é¢˜  
[ ] éªŒè¯ ç¾¤æç¤ºæ¶ˆæ¯ä¿®æ”¹æ—¶ ä¸èƒ½è·å–åˆ°å…·ä½“ç±»å‹çš„é—®é¢˜  
[ ] è…¾è®¯äº‘ç¦»çº¿æ¨é€  
[ ] TIMProfileSystemElem  
[ ] TIMGroupSystemElem  

### ä¸‹ç‰ˆæœ¬è®¡åˆ’(0.3.0)
1. å°†ä¸åŒç±»åˆ«çš„æ–¹æ³•å°è£…åˆ°ä¸åŒå®ä½“

## é›†æˆ
### Flutter
```
tencent_im_plugin: ^[æœ€æ–°ç‰ˆæœ¬å·]
```

### Android ç«¯é›†æˆ
æ— éœ€é¢å¤–é…ç½®ï¼Œå·²å†…éƒ¨æ‰“å…¥æ··æ·†é…ç½®

### IOS
æ— éœ€é¢å¤–é…ç½®

## ä½¿ç”¨
Demoæˆªå›¾:  
<img src="https://raw.githubusercontent.com/JiangJuHong/access-images/master/FlutterTencentImPlugin/1.png" height="300em" style="max-width:100%;display: inline-block;"/>
<img src="https://raw.githubusercontent.com/JiangJuHong/access-images/master/FlutterTencentImPlugin/2.png" height="300em" style="max-width:100%;display: inline-block;"/>
<img src="https://raw.githubusercontent.com/JiangJuHong/access-images/master/FlutterTencentImPlugin/3.png" height="300em" style="max-width:100%;display: inline-block;"/>
<img src="https://raw.githubusercontent.com/JiangJuHong/access-images/master/FlutterTencentImPlugin/4.png" height="300em" style="max-width:100%;display: inline-block;"/>
<img src="https://raw.githubusercontent.com/JiangJuHong/access-images/master/FlutterTencentImPlugin/5.png" height="300em" style="max-width:100%;display: inline-block;"/>
<img src="https://raw.githubusercontent.com/JiangJuHong/access-images/master/FlutterTencentImPlugin/6.png" height="300em" style="max-width:100%;display: inline-block;"/>
<img src="https://raw.githubusercontent.com/JiangJuHong/access-images/master/FlutterTencentImPlugin/7.png" height="300em" style="max-width:100%;display: inline-block;"/>
<img src="https://raw.githubusercontent.com/JiangJuHong/access-images/master/FlutterTencentImPlugin/8.png" height="300em" style="max-width:100%;display: inline-block;"/>

## åŠŸèƒ½æ¸…å•
### æ¶ˆæ¯å‘é€èŠ‚ç‚¹
|  èŠ‚ç‚¹  |  è¿›åº¦  |  è¯´æ˜  |
|  ----  | ---- |  ---- |
|  TextMessageNode  |  âˆš |  æ–‡æœ¬æ¶ˆæ¯ |
|  ImageMessageNode  |  âˆš |  å›¾ç‰‡æ¶ˆæ¯ |
|  SoundMessageNode  |  âˆš |  è¯­éŸ³æ¶ˆæ¯ |
|  VideoMessageNode  |  âˆš |  è§†é¢‘æ¶ˆæ¯ |
|  CustomMessageNode  |  âˆš | è‡ªå®šä¹‰æ¶ˆæ¯ |
|  LocationMessageNode  |  âˆš | ä½ç½®æ¶ˆæ¯ |

### æ¶ˆæ¯æ¥æ”¶èŠ‚ç‚¹
|  èŠ‚ç‚¹  |  è¿›åº¦  |  è¯´æ˜  |
|  ----  | ---- |  ---- |
|  TIMCustomElem  |  âˆš |  å·²å®Œæˆ |
|  TIMFaceElem  |  - |  æš‚ä¸è€ƒè™‘ |
|  TIMFileElem  |  - |  æš‚ä¸è€ƒè™‘ï¼Œå»ºè®®ä½¿ç”¨ TIMCustomElem ä»£æ›¿ |
|  TIMGroupSystemElem  |  - |  è®¡åˆ’å†… |
|  TIMGroupTipsElem  | âˆš |  å·²å®Œæˆ |
|  TIMImageElem  |  âˆš |  å·²å®Œæˆ |
|  TIMLocationElem  |  âˆš |  å·²å®Œæˆ |
|  TIMProfileSystemElem  |  - |  è®¡åˆ’å†…å®¹ |
|  TIMSNSSystemElem  |  âˆš |  å·²å®Œæˆ |
|  TIMSoundElem  |  âˆš |  å·²å®Œæˆ |
|  TIMTextElem  |  âˆš |  å·²å®Œæˆ |
|  TIMVideoElem  |  âˆš |  å·²å®Œæˆ |
|  OtherMessageNode  |  âˆš |  å·²å®Œæˆï¼Œä»…Androidï¼ˆIOSèƒ½å¤Ÿè§£æï¼Œä½†æ˜¯å†…å®¹ä½“æ²¡æœ‰æ•°æ®ï¼‰ |

### æ¥å£(å³æ»‘æŸ¥çœ‹è¯¦ç»†å‚æ•°)
|  æ¥å£   | è¯´æ˜  | å‚æ•°  | Android | IOS |
|  ----  | ----  | ----  | ----  | ----  |
| init  | åˆå§‹åŒ– | {appid:"xxxxxx",enabledLogPrint:"æ˜¯å¦å¯ç”¨æ—¥å¿—æ‰“å°",logPrintLevel:"æ—¥å¿—æ‰“å°çº§åˆ«"} | âˆš | âˆš
| login  | ç™»å½• | {identifier:'ç”¨æˆ·ID',userSig:'ç”¨æˆ·ç­¾å'} | âˆš | âˆš
| logout  | ç™»å‡º | - | âˆš | âˆš
| getLoginUser  | è·å¾—å½“å‰ç™»å½•ç”¨æˆ·ID | - | âˆš | âˆš
| initStorage  | åˆå§‹åŒ–æœ¬åœ°å­˜å‚¨(å¦‚æœè¿™ä¸ªæ–¹æ³•åœ¨ login åè¿›è¡Œ await è°ƒç”¨ï¼Œåˆ™ä¼šé€ æˆå¡æ­») | {identifier: 'ç”¨æˆ·ID'} | âˆš | âˆš
| getConversationList  | è·å¾—ä¼šè¯åˆ—è¡¨(å¦‚æœæ˜¯ç¦»çº¿çŠ¶æ€ï¼Œåˆ™è·å–å‡ºæ¥çš„ä¼šè¯åˆ—è¡¨ä¸åŒ…å«: Groupã€UserProfile ä¿¡æ¯) | - | âˆš | âˆš 
| getConversation  | è·å¾—å•ä¸ªä¼šè¯(å¦‚æœæ˜¯ç¦»çº¿çŠ¶æ€ï¼Œåˆ™è·å–å‡ºæ¥çš„ä¼šè¯åˆ—è¡¨ä¸åŒ…å«: Groupã€UserProfile ä¿¡æ¯) | {id:'ä¼šè¯ID',sessionType:'ä¼šè¯ç±»å‹} | âˆš | âˆš 
| getGroupInfo  | è·å¾—ç¾¤ä¿¡æ¯(äº‘ç«¯) | {id:'ç¾¤ID'} | âˆš | âˆš
| getUserInfo  | è·å¾—ç”¨æˆ·ä¿¡æ¯ | {id:'ç”¨æˆ·ID',forceUpdate:"æ˜¯å¦ä»äº‘ç«¯æ‹‰å–æ•°æ®ï¼Œé»˜è®¤ä¸ºfalse"} | âˆš | âˆš
| setRead  | è®¾ç½®å·²è¯» | {sessionId:'ä¼šè¯ID',sessionType:'ä¼šè¯ç±»å‹ï¼Œæšä¸¾å€¼:SessionType' } | âˆš | âˆš
| getMessages  | è·å¾—æ¶ˆæ¯åˆ—è¡¨(å¦‚æœæ˜¯ç¦»çº¿çŠ¶æ€ï¼Œåˆ™è·å–å‡ºæ¥çš„æ¶ˆæ¯ä¸åŒ…å« UserProfile ä¿¡æ¯) | {sessionId:'ä¼šè¯ID',sessionType:'ä¼šè¯ç±»å‹ï¼Œæšä¸¾å€¼:SessionType',number:"ä¼šè¯æ•°é‡",lastMessage:'æœ€åä¸€æ¡æ¶ˆæ¯'} | âˆš | âˆš
| getLocalMessages  | è·å¾—æœ¬åœ°æ¶ˆæ¯åˆ—è¡¨(å¦‚æœæ˜¯ç¦»çº¿çŠ¶æ€ï¼Œåˆ™è·å–å‡ºæ¥çš„æ¶ˆæ¯ä¸åŒ…å« UserProfile ä¿¡æ¯) | {sessionId:'ä¼šè¯ID',sessionType:'ä¼šè¯ç±»å‹ï¼Œæšä¸¾å€¼:SessionType',number:"ä¼šè¯æ•°é‡",lastMessage:'æœ€åä¸€æ¡æ¶ˆæ¯'} | âˆš | âˆš
| sendMessage  | å‘é€æ¶ˆæ¯ | {sessionId:'ä¼šè¯ID',sessionType:'ä¼šè¯ç±»å‹ï¼Œæšä¸¾å€¼:SessionType',ol:"æ˜¯å¦æ˜¯åœ¨çº¿æ¶ˆæ¯ï¼ˆæ— ç—•ï¼‰",node:æ¶ˆæ¯èŠ‚ç‚¹å¯¹è±¡} | âˆš | âˆš
| saveMessage  | å‘æœ¬åœ°æ¶ˆæ¯åˆ—è¡¨ä¸­æ·»åŠ ä¸€æ¡æ¶ˆæ¯ï¼Œä½†å¹¶ä¸å°†å…¶å‘é€å‡ºå»ã€‚ | {sessionId:'ä¼šè¯ID',sessionType:'ä¼šè¯ç±»å‹ï¼Œæšä¸¾å€¼:SessionType',node:æ¶ˆæ¯èŠ‚ç‚¹å¯¹è±¡,sender:"å‘é€äºº",isReaded:'æ˜¯å¦å·²è¯»'} | âˆš | âˆš
| getFriendList  | è·å¾—å¥½å‹åˆ—è¡¨ | - | âˆš | âˆš
| getGroupList  | è·å¾—ç¾¤ç»„åˆ—è¡¨ | - | âˆš | âˆš
| addFriend  | æ·»åŠ å¥½å‹ | {id:'ç”¨æˆ·ID',addType:'æ·»åŠ ç±»å‹',remark:'å¤‡æ³¨',addWording:'è¯·æ±‚è¯´æ˜',addSource:'æ·»åŠ æ¥æº',friendGroup:'åˆ†ç»„å'} | âˆš | âˆš
| checkSingleFriends  | æ£€æµ‹å•ä¸ªå¥½å‹å…³ç³» | {id:'ç”¨æˆ·ID',type:'æ£€æµ‹ç±»å‹'} | âˆš | âˆš
| getPendencyList  | è·å¾—æœªå†³å¥½å‹åˆ—è¡¨(ç”³è¯·ä¸­) | {type:'ç±»å‹',seq:'æœªå†³åˆ—è¡¨åºåˆ—å·',timestamp:'ç¿»é¡µæ—¶é—´æˆ³',numPerPage:'æ¯é¡µæ•°é‡'} | âˆš | âˆš
| pendencyReport  | æœªå†³å·²è¯»ä¸ŠæŠ¥ | {timestamp:"æ—¶é—´æˆ³"} | âˆš | âˆš
| deletePendency  | æœªå†³åˆ é™¤ | {id:'ç”¨æˆ·Id',type:'ç±»å‹'}| âˆš | âˆš
| examinePendency  | æœªå†³å®¡æ ¸ | {id:'ç”¨æˆ·ID',type:'ç±»å‹',remark:'å¤‡æ³¨'} | âˆš | âˆš 
| deleteConversation  | åˆ é™¤ä¼šè¯ | {sessionId:'ä¼šè¯ID',sessionType:'ä¼šè¯ç±»å‹ï¼Œæšä¸¾å€¼:SessionType',removeCache:'æ˜¯å¦åˆ é™¤æœ¬åœ°æ¶ˆæ¯ç¼“å­˜'} | âˆš | âˆš
| deleteLocalMessage  | åˆ é™¤ä¼šè¯å†…çš„æœ¬åœ°èŠå¤©è®°å½• | {sessionId:'ä¼šè¯ID',sessionType:'ä¼šè¯ç±»å‹ï¼Œæšä¸¾å€¼:SessionType'} | âˆš | âˆš
| createGroup  | åˆ›å»ºç¾¤ç»„ | {groupId:'æŒ‡å®šç¾¤ID',notification:'ç¾¤å…¬å‘Š',introduction:'æè¿°',faceUrl:'å¤´åƒ',addOption:'å…¥ç¾¤ç±»å‹',maxMemberNum:'æœ€å¤§æˆå‘˜æ•°é‡',members:'æˆå‘˜é›†åˆ',type:'ç±»å‹',name:'ç¾¤å'} | âˆš | âˆš
| inviteGroupMember  | é‚€è¯·åŠ å…¥ç¾¤ç»„ | {groupId:'ç¾¤ID',ids:'ç¾¤æˆå‘˜ID'} | âˆš | âˆš
| applyJoinGroup  | ç”³è¯·åŠ å…¥ç¾¤ç»„ | {groupId:'ç¾¤ID',reason:'ç”³è¯·è¯´æ˜'} | âˆš | âˆš
| quitGroup  | é€€å‡ºç¾¤ç»„ | {groupId:'ç¾¤ID'} | âˆš | âˆš
| deleteGroupMember  | åˆ é™¤ç¾¤ç»„æˆå‘˜ | {groupId:'ç¾¤ID',ids:'ç”¨æˆ·IDé›†åˆ',reason:"åˆ é™¤è¯´æ˜"} | âˆš | âˆš
| getGroupMembers  | è·å¾—ç¾¤æˆå‘˜åˆ—è¡¨ | {groupId:'ç¾¤ID'} | âˆš | âˆš
| deleteGroup  | è§£æ•£ç¾¤ç»„ | {groupId:'ç¾¤ID'} | âˆš | âˆš
| modifyGroupOwner  | è½¬è®©ç¾¤ç»„ | {groupId:'ç¾¤ID',identifier:'æ–°ç¾¤ä¸»ID'} | âˆš | âˆš
| modifyGroupInfo  | ä¿®æ”¹ç¾¤ç»„èµ„æ–™ | {groupId:'æŒ‡å®šç¾¤ID',notification:'ç¾¤å…¬å‘Š',introduction:'æè¿°',faceUrl:'å¤´åƒ',addOption:'å…¥ç¾¤ç±»å‹',maxMemberNum:'æœ€å¤§æˆå‘˜æ•°é‡(IOSä¸æ”¯æŒ)',type:'ç±»å‹',groupName:'ç¾¤å',visable:'æ˜¯å¦å¯¹å¤–å¯è§',silenceAll:'å…¨å‘˜ç¦è¨€',customInfo:'è‡ªå®šä¹‰ä¿¡æ¯'} | âˆš | âˆš
| modifyMemberInfo  | ä¿®æ”¹ç¾¤æˆå‘˜èµ„æ–™ | {groupId:'ç¾¤ID',identifier:'ç¾¤æˆå‘˜ID',nameCard:'åç‰‡',receiveMessageOpt:'æ¥æ”¶æ¶ˆæ¯é€‰é¡¹ï¼Œæ³¨:IOSä¸æ”¯æŒ',silence:'ç¦è¨€æ—¶é—´',role:'è§’è‰²',customInfo:'è‡ªå®šä¹‰æ•°æ®'} | âˆš | âˆš
| getGroupPendencyList  | è·å¾—æœªå†³ç¾¤åˆ—è¡¨ | {timestamp:'ç¿»é¡µæ—¶é—´æˆ³',numPerPage:'æ¯é¡µçš„æ•°é‡'} | âˆš | âˆš
| reportGroupPendency  | ä¸ŠæŠ¥ç¾¤æœªå†³å·²è¯» | {timestamp:'å·²è¯»æ—¶é—´æˆ³'} | âˆš | âˆš
| groupPendencyAccept  | ç¾¤æœªå†³å®¡æ ¸ï¼ˆåŒæ„ï¼‰ä¼šéå†æ‰€æœ‰æœªå†³åˆ—è¡¨æ¥è·å¾—æœªå®¡æ ¸çš„åˆ—è¡¨ï¼Œå­˜åœ¨æ€§èƒ½éšæ‚£ | {msg:'å®¡æ ¸æ„è§',groupId:'ç¾¤ID',identifier:'ç”³è¯·äººID',addTime:'ç”³è¯·æ—¶é—´'} | âˆš | âˆš
| groupPendencyRefuse  | ç¾¤æœªå†³å®¡æ ¸ï¼ˆæ‹’ç»ï¼‰ä¼šéå†æ‰€æœ‰æœªå†³åˆ—è¡¨æ¥è·å¾—æœªå®¡æ ¸çš„åˆ—è¡¨ï¼Œå­˜åœ¨æ€§èƒ½éšæ‚£ | {msg:'å®¡æ ¸æ„è§',groupId:'ç¾¤ID',identifier:'ç”³è¯·äººID',addTime:'ç”³è¯·æ—¶é—´'} | âˆš | âˆš
| getSelfProfile  | è·å–ç™»å½•ç”¨æˆ·èµ„æ–™ | {forceUpdate:"æ˜¯å¦å¼ºåˆ¶èµ°åå°æ‹‰å–"} | âˆš | âˆš
| modifySelfProfile  | ä¿®æ”¹ç™»å½•ç”¨æˆ·èµ„æ–™(https://cloud.tencent.com/document/product/269/1500#.E6.A0.87.E9.85.8D.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5) | {params:'ä¿®æ”¹å‚æ•°'} | âˆš | âˆš
| modifyFriend  | ä¿®æ”¹å¥½å‹èµ„æ–™(https://cloud.tencent.com/document/product/269/1500#.E6.A0.87.E9.85.8D.E8.B5.84.E6.96.99.E5.AD.97.E6.AE.B5) | {identifier:'å¥½å‹ID',params:'ä¿®æ”¹å‚æ•°'} | âˆš | âˆš
| deleteFriends  | åˆ é™¤å¥½å‹ | {ids:"ç”¨æˆ·IDåˆ—è¡¨",delFriendType:'åˆ é™¤ç±»å‹'} | âˆš | âˆš
| addBlackList  | æ·»åŠ åˆ°é»‘åå• | {ids:"ç”¨æˆ·IDåˆ—è¡¨"} | âˆš | âˆš
| deleteBlackList  | ä»é»‘åå•åˆ é™¤ | {ids:"ç”¨æˆ·IDåˆ—è¡¨"} | âˆš | âˆš
| getBlackList  | è·å¾—é»‘åå•åˆ—è¡¨ | - | âˆš | âˆš
| createFriendGroup  | åˆ›å»ºå¥½å‹åˆ†ç»„ | {groupNames:'ç»„ååˆ—è¡¨',ids:'ç”¨æˆ·åˆ—è¡¨'} | âˆš | âˆš
| deleteFriendGroup  | åˆ é™¤å¥½å‹åˆ†ç»„ | {groupNames:'ç»„ååˆ—è¡¨'} | âˆš | âˆš
| addFriendsToFriendGroup  | æ·»åŠ å¥½å‹åˆ°æŸä¸ªåˆ†ç»„ | {groupName:'ç»„å',ids:'IDåˆ—è¡¨'} | âˆš | âˆš
| deleteFriendsFromFriendGroup  | ä»åˆ†ç»„åˆ é™¤å¥½å‹ | {groupName:'ç»„å',ids:'IDåˆ—è¡¨'} | âˆš | âˆš
| renameFriendGroup  | é‡å‘½ååˆ†ç»„ | {oldGroupName:'æ—§åç§°',newGroupName:'æ–°åç§°'} | âˆš | âˆš
| getFriendGroups  | è·å¾—å¥½å‹åˆ†ç»„ | {groupNames:'ç»„å'} | âˆš | âˆš
| revokeMessage | æ’¤å›ä¸€æ¡å‘é€æˆåŠŸçš„æ¶ˆæ¯ | {message:'æ¶ˆæ¯å¯¹è±¡'} | âˆš | âˆš
| removeMessage | åˆ é™¤ä¸€æ¡æ¶ˆæ¯(æœ¬åœ°) | {message:'æ¶ˆæ¯å¯¹è±¡'} | âˆš | âˆš
| setMessageCustomInt | è®¾ç½®è‡ªå®šä¹‰æ•´æ•° | {message:'æ¶ˆæ¯å¯¹è±¡',value:'è‡ªå®šä¹‰å€¼'} | âˆš | âˆš
| setMessageCustomStr | è®¾ç½®è‡ªå®šä¹‰æ•´æ•° | {message:'æ¶ˆæ¯å¯¹è±¡',value:'è‡ªå®šä¹‰å€¼'} | âˆš | âˆš
| downloadVideoImage | è·å¾—è§†é¢‘å›¾ç‰‡(ç¼©ç•¥å›¾) | {message:'æ¶ˆæ¯å¯¹è±¡',path:'ä¿å­˜æˆªå›¾çš„è·¯å¾„'} | âˆš | âˆš
| downloadVideo | è·å¾—è§†é¢‘ | {message:'æ¶ˆæ¯å¯¹è±¡',path:'ä¿å­˜è§†é¢‘çš„è·¯å¾„'} | âˆš | âˆš
| downloadSound | è·å¾—è¯­éŸ³ | {message:'æ¶ˆæ¯å¯¹è±¡',path:'ä¿å­˜è¯­éŸ³çš„è·¯å¾„'} | âˆš | âˆš
| findMessage | æŸ¥æ‰¾ä¸€æ¡æ¶ˆæ¯ | {sessionId:'ä¼šè¯ID',sessionType:'ä¼šè¯ç±»å‹',rand:'éšæœºç ',seq:'æ¶ˆæ¯ç³»åˆ—å·',timestamp:'æ¶ˆæ¯æ—¶é—´æˆ³',self:'æ˜¯å¦æ˜¯è‡ªå·±å‘é€çš„æ¶ˆæ¯'} | âˆš | âˆš
| setOfflinePushSettings | è®¾ç½®ç¦»çº¿æ¨é€ç›¸å…³è®¾ç½®(è¯·ä¿è¯è¯¥æ–¹æ³•åœ¨ç™»å½•åè°ƒç”¨) | {enabled:'æ˜¯å¦å¯ç”¨',c2cSound:'C2CéŸ³é¢‘æ–‡ä»¶',groupSound:'GroupéŸ³é¢‘æ–‡ä»¶',videoSound:'è§†é¢‘é‚€è¯·è¯­éŸ³'} | âˆš | âˆš
| setOfflinePushToken | è®¾ç½®ç¦»çº¿æ¨é€ç›¸å…³Token(ç™»å½•ä¹‹åè°ƒç”¨) | {token:'å„ä¸ªæ‰‹æœºå‚å•†çš„æ¨é€æœåŠ¡å¯¹å®¢æˆ·ç«¯çš„å”¯ä¸€æ ‡è¯†ï¼Œéœ€è¦é›†æˆå„ä¸ªå‚å•†çš„æ¨é€æœåŠ¡è·å–',bussid:'æ¨é€è¯ä¹¦ IDï¼Œæ˜¯åœ¨ IM æ§åˆ¶å°ä¸Šç”Ÿæˆçš„'} | âˆš | âˆš

### æ¶ˆæ¯ç›‘å¬
é€šè¿‡ `TencentImPlugin.addListener` å’Œ `TencentImPlugin.removeListener` å¯è¿›è¡Œäº‹ä»¶ç›‘å¬  
````dart
@override
vodi initState(){
  super.initState();
  TencentImPlugin.addListener(_messageListener);
}
@override
void dispose() {
  super.dispose();
  TencentImPlugin.removeListener(_messageListener);
}

 _messageListener(ListenerTypeEnum type, params) {
  // you code
};
````
æ³¨æ„ï¼šaddListener åï¼Œè¯·æ³¨æ„åœ¨å¿…è¦æ—¶è¿›è¡Œ removeListener

### ç¦»çº¿æ¨é€
æ³¨æ„: æœ¬æ’ä»¶ä»…åœ¨è…¾è®¯äº‘IMä¸Šè¿›è¡Œå°è£…ï¼Œå¹¶æœªé›†æˆå°ç±³ã€åä¸ºç­‰æ¨é€æ–¹çš„SDKï¼Œæ•…é›†æˆç¦»çº¿æ¨é€æ—¶æ ¹æ®è…¾è®¯äº‘æ–‡æ¡£è¿›è¡Œé›†æˆã€‚å·²å°è£…ç¦»çº¿æ¨é€é…ç½®æ–¹æ³•ã€‚  

#### ç¦»çº¿æ¨é€ç›¸å…³æ¥å£
`setOfflinePushSettings`: è®¾ç½®ç¦»çº¿æ¨é€ç›¸å…³è®¾ç½®ï¼ŒåŒ…å«ï¼šæ˜¯å¦å¯ç”¨ã€C2Cæ¶ˆæ¯è¯­éŸ³ã€ç¾¤èŠæ¶ˆæ¯è¯­éŸ³å’Œè§†é¢‘é‚€è¯·è¯­éŸ³ã€‚è¯·ä¿è¯è¯¥æ–¹æ³•åœ¨ç™»å½•åè°ƒç”¨ï¼  
`setOfflinePushToken`: è®¾ç½®ç¦»çº¿æ¨é€ç›¸å…³Tokenï¼Œtoken æ˜¯å„ä¸ªæ‰‹æœºå‚å•†çš„æ¨é€æœåŠ¡å¯¹å®¢æˆ·ç«¯çš„å”¯ä¸€æ ‡è¯†ï¼Œéœ€è¦é›†æˆå„ä¸ªå‚å•†çš„æ¨é€æœåŠ¡è·å–ï¼› bussid æ˜¯æ¨é€è¯ä¹¦ IDï¼Œæ˜¯åœ¨ IM æ§åˆ¶å°ä¸Šç”Ÿæˆçš„ï¼Œ å…·ä½“æ­¥éª¤è¯·å‚è€ƒ https://cloud.tencent.com/document/product/269/9234

#### æ ¹æ®è…¾è®¯äº‘IMæ–‡æ¡£è¿›è¡Œé›†æˆç¬¬ä¸‰æ–¹SDKï¼Œå¹¶é…ç½®Token
[Android](https://cloud.tencent.com/document/product/269/44516)  
[IOS](https://cloud.tencent.com/document/product/269/44517)  
ç¤ºä¾‹: å°ç±³æ¨é€
1. æ ¹æ®è…¾è®¯äº‘æ–‡æ¡£é…ç½®è¯ä¹¦(bussid)å¹¶ä¸‹è½½å°ç±³æ¨é€SDK  
2. åœ¨ `android/app` ç›®å½•åˆ›å»º `libs` æ–‡ä»¶å¤¹ï¼Œå¹¶å°†å°ç±³æ¨é€SDKæ‹·è´
    `android/app/libs/MiPush_SDK_Client_3_7_6.jar`
3. ç¼–å†™ `app/build.gradle` æ–‡ä»¶ï¼Œå¼•å…¥ libs çš„jaråŒ…
   ````
   dependencies {
       api fileTree(include: ['*.jar'], dir: 'libs')
   }
   ````
4. ç¼–å†™ `android/app/src/main/AndroidManifest.xml` æ–‡ä»¶ï¼Œæ·»åŠ æƒé™
    ````
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
    <uses-permission android:name="android.permission.READ_PHONE_STATE" />
    <uses-permission android:name="android.permission.GET_TASKS" />
    <uses-permission android:name="android.permission.VIBRATE" />

    <permission
        android:name="top.huic.tencent_im_plugin_example.permission.MIPUSH_RECEIVE"
        android:protectionLevel="signature" />
    <uses-permission android:name="top.huic.tencent_im_plugin_example.permission.MIPUSH_RECEIVE" /> 
   ````
   æ³¨æ„: è¯·å°† `top.huic.tencent_im_plugin_example` æ›¿æ¢ä¸ºä½ çš„åŒ…å
   
5. ç¼–å†™ `android/app/src/main/AndroidManifest.xml`ï¼Œåœ¨ `application` æ ‡ç­¾ä¸­æ·»åŠ 
    ````
   <service
       android:name="com.xiaomi.push.service.XMPushService"
       android:enabled="true"
       android:process=":pushservice" />
   <service
       android:name="com.xiaomi.push.service.XMJobService"
       android:enabled="true"
       android:exported="false"
       android:permission="android.permission.BIND_JOB_SERVICE"
       android:process=":pushservice" />
   <service
       android:name="com.xiaomi.mipush.sdk.PushMessageHandler"
       android:enabled="true"
       android:exported="true" />
   <service
       android:name="com.xiaomi.mipush.sdk.MessageHandleService"
       android:enabled="true" />
   <receiver
       android:name="com.xiaomi.push.service.receivers.NetworkStatusReceiver"
       android:exported="true">
       <intent-filter>
           <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />
           <category android:name="android.intent.category.DEFAULT" />
       </intent-filter>
   </receiver>
   <receiver
       android:name="com.xiaomi.push.service.receivers.PingReceiver"
       android:exported="false"
       android:process=":pushservice">
       <intent-filter>
           <action android:name="com.xiaomi.push.PING_TIMER" />
       </intent-filter>
   </receiver>
   ````
6. æ›´æ”¹ `android/app/src/main/MainActivity.java` æ–‡ä»¶ï¼ŒåŠ å…¥å¦‚ä¸‹ä»£ç 
    ````java
   
   /**
    * Flutter é€šçŸ¥å™¨
    */
    public static MethodChannel channel;
   
   @Override
   protected void onCreate(@Nullable Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       if (shouldInit()) {
           MiPushClient.registerPush(this, APP_ID, APP_KEY);
       }
       channel = new MethodChannel(this.getFlutterEngine().getDartExecutor(), "tencent_im_plugin_example");
   }
   
   /**
    * é€šè¿‡åˆ¤æ–­æ‰‹æœºé‡Œçš„æ‰€æœ‰è¿›ç¨‹æ˜¯å¦æœ‰è¿™ä¸ªAppçš„è¿›ç¨‹
    * ä»è€Œåˆ¤æ–­è¯¥Appæ˜¯å¦æœ‰æ‰“å¼€
    *
    * @return æ˜¯å¦éœ€è¦åˆå§‹åŒ– -true éœ€è¦
    */
   private boolean shouldInit() {
       // é€šè¿‡ActivityManageræˆ‘ä»¬å¯ä»¥è·å¾—ç³»ç»Ÿé‡Œæ­£åœ¨è¿è¡Œçš„activities
       // åŒ…æ‹¬è¿›ç¨‹(Process)ç­‰ã€åº”ç”¨ç¨‹åº/åŒ…ã€æœåŠ¡(Service)ã€ä»»åŠ¡(Task)ä¿¡æ¯ã€‚
       ActivityManager am = ((ActivityManager) getSystemService(Context.ACTIVITY_SERVICE));
       List<ActivityManager.RunningAppProcessInfo> processInfos = am.getRunningAppProcesses();
       String mainProcessName = getPackageName();

       // è·å–æœ¬Appçš„å”¯ä¸€æ ‡è¯†
       int myPid = android.os.Process.myPid();
       // åˆ©ç”¨ä¸€ä¸ªå¢å¼ºforå¾ªç¯å–å‡ºæ‰‹æœºé‡Œçš„æ‰€æœ‰è¿›ç¨‹
       for (ActivityManager.RunningAppProcessInfo info : processInfos) {
           // é€šè¿‡æ¯”è¾ƒè¿›ç¨‹çš„å”¯ä¸€æ ‡è¯†å’ŒåŒ…ååˆ¤æ–­è¿›ç¨‹é‡Œæ˜¯å¦å­˜åœ¨è¯¥App
           if (info.pid == myPid && mainProcessName.equals(info.processName)) {
               return true;
           }
       }
       return false;
   }
    ````
7. åœ¨`android/app/src/main/` ä¸­åˆ›å»ºåŒ… `push`(éå¿…é¡»)
8. åœ¨ `android/app/src/main/push` åˆ›å»ºç±»:`XiaomiMsgReceiver`
    ````java
   public class XiaomiMsgReceiver extends PushMessageReceiver {
       @Override
       public void onReceiveRegisterResult(Context context, MiPushCommandMessage message) {
           String command = message.getCommand();
           List<String> arguments = message.getCommandArguments();
           String cmdArg1 = ((arguments != null && arguments.size() > 0) ? arguments.get(0) : null);
   
           String token = null;
           if (MiPushClient.COMMAND_REGISTER.equals(command)) {
               if (message.getResultCode() == ErrorCode.SUCCESS) {
                   token = cmdArg1;
               }
           }
   
           // è°ƒç”¨é€šçŸ¥ç›‘å¬å™¨ä¼ é€’åˆ°Flutterå±‚
           Handler mainHandler = new Handler(Looper.getMainLooper());
           String finalToken = token;
           mainHandler.post(() -> MainActivity.channel.invokeMethod("miPushTokenListener", finalToken));
       }
   }
   ````
   æ”¯æŒï¼ŒAndroidå¼€å‘å·¥ä½œå®Œæˆï¼Œæ¥ä¸‹æ¥å°±æ˜¯Flutterç«¯å·¥ä½œ
9. åœ¨ lib ç›®å½•åˆ›å»º `tencent_im_plugin_example.dart`
    ````
   class TencentImPluginExample {
     static const MethodChannel _channel = const MethodChannel('tencent_im_plugin_example');
   
     /// å°ç±³æ¨é€TOken
     static String miPushToken;
   
     /// è®¾ç½®ç›‘å¬å™¨
     static setListener(){
       _channel.setMethodCallHandler((call) {
         if (call.method == 'miPushTokenListener') {
           miPushToken = call.arguments as String;
         }
         return null;
       });
     }
   }
   ````
10. åœ¨ç¨‹åºå¯åŠ¨åè°ƒç”¨
   ````
   TencentImPluginExample.setListener();
   ````
11. æœ€åï¼Œåœ¨ç™»å½•ä¹‹åè°ƒç”¨ `setOfflinePushToken` å³å¯ï¼Œå¯ä½¿ç”¨ è…¾è®¯äº‘ç¦»çº¿æ¨é€è‡ªæŸ¥å·¥å…·æŸ¥çœ‹æ˜¯å¦æ³¨å†ŒæˆåŠŸ
   ````
   if(TencentImPluginExample.miPushToken != null){
     await TencentImPlugin.setOfflinePushToken(token: TencentImPluginExample.miPushToken,bussid: 10301);
   }
   ````
12. exampleå·²ç»é›†æˆå°ç±³æ¨é€ï¼Œå¯å‚è€ƒè¿›è¡Œé…ç½®


#### ç¼ºé™·
å¦‚æœæ‚¨è¦é›†æˆå¤šä¸ªå¹³å°ï¼Œé‚£ä¹ˆéœ€è¦é¢‘ç¹ä¿®æ”¹ Android é…ç½®å’Œ Android ä»£ç ï¼Œè¿™å¯¹Flutteræ–°æ‰‹æ˜¯æå…¶ä¸å‹å¥½çš„ï¼Œæ•…è®¡åˆ’æä¾›åˆ†æ”¯æ’ä»¶(ä¸ç¡®å®šä»€ä¹ˆæ—¶å€™):å°ç±³ã€åä¸ºç­‰æ¨é€SDKé›†æˆï¼Œå¦‚æœæ‚¨å·²ç»æœ‰ç±»ä¼¼æ’ä»¶ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šä½¿ç”¨å®ƒå¹¶ç¼–å†™æ¥å…¥æ–‡æ¡£